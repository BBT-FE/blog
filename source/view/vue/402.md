---
title: vue的优点是什么
date:
tag:
 - 出云
photos:
 
---
<!-- 引言（简介） -->
  我在加班整理试题，
  你在跟别人再打游戏。
  因为喜欢，对你纵容；
  因为在乎，不想让你太累。
  我太难了
  不知道，对你的感觉还能多久；
  哎！ 终将会失去。
  姑娘啊，珍重! 
   - 愿你活成你想要的样子
<!--more-->

<!-- 详细内容 -->
#### 优点
  - 低耦合。视图（View）可以独立于Model变化和修改，一个ViewModel可以绑定到不同的"View"上，当View变化的时候Model可以不变，当Model变化的时候View也可以不变。
 
  - 可重用性。你可以把一些视图逻辑放在一个ViewModel里面，让很多view重用这段视图逻辑。
  
  - 独立开发。开发人员可以专注于业务逻辑和数据的开发（ViewModel），设计人员可以专注于页面设计。

#### 双向绑定原理
  vue数据双向绑定是通过`数据劫持结合发布者-订阅者模式`的方式来实现的。

  实现数据的双向绑定

  首先要对数据进行劫持监听，所以我们需要设置一个监听器Observer，用来监听所有属性。如果属性发上变化了，就需要告诉订阅者Watcher看是否需要更新。订阅者是有很多个，所以我们需要有一个消息订阅器Dep来专门收集这些订阅者，然后在监听器Observer和订阅者Watcher之间进行统一管理的。接着，我们还需要有一个指令解析器Compile，对每个节点元素进行扫描和解析，将相关指令（如v-model，v-on）对应初始化成一个订阅者Watcher，并替换模板数据或者绑定相应的函数，此时当订阅者Watcher接收到相应属性的变化，就会执行对应的更新函数，从而更新视图.大致分为以下三步

  1. 实现一个监听器Observer，用来劫持并监听所有属性，如果有变动的，就通知订阅者。

    - Observer： 是一个数据监听器，其实现核心方法就是Object.defineProperty()，Object.defineProperty来劫持对象属性的setter和getter操作（vm.data属性全部转成setter、getter方法。）并“种下”一个监听器，当数据发生变化的时候发出通知。
    - 利用set和get。。我们将要observe的对象，通过递归，将它所有的属性，包括子属性的属性，都给加上set和get，

    ```js
    function observe(data){ 
      if(typeof data !== 'object'){//不是对象不进行数据劫持
          return
      }
      return new Observe(data);
      }

      //将model->vm.data
      function Observe(data){
        for(let key in data){//遍历所有属性进行劫持
          let val = data[key];
          observe(val);//深入递归数据劫持exp：data:{a:{a:3},b:5}}
          Object.defineProperty(data,key,{
            enumerable: true,
            get(){
              return val//此时的val已经进行了数据劫持，exp：{a:3}
            },
            set(newVal){
              if(newVal === val ){//值不变则返回
                  return
              }
              val = newVal;
              observe(newVal);//新赋的值也必须进行数据劫持
            }
          }
        }
      }
  ```

  2. 实现一个订阅者Watcher，每一个Watcher都绑定一个更新函数，watcher可以收到属性的变化通知并执行相应的函数，从而更新视图。

    - Watcher就是一个订阅者。用于将Observer发来的update消息处理，执行Watcher绑定的更新函数。
    - 订阅者就调用自己的update方法（肯定会有一个updaata方法）

  3. 实现一个解析器Compile，可以扫描和解析每个节点的相关指令（v-model，v-on等指令），如果节点存在v-model，v-on等指令，则解析器Compile初始化这类节点的模板数据，使之可以显示在视图上，然后初始化相应的订阅者（Watcher）。


#### 实现一个MVVM

- a、Observer实现对MVVM自身model数据劫持，监听数据的属性变更，并在变动时进行notify
- b、Compile实现指令解析，初始化视图，并订阅数据变化，绑定好更新函数
- c、Watcher一方面接收Observer通过dep传递过来的数据变化，一方面通知Compile进行view update。
